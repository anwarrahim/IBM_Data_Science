<html>
<head>
<title>Pandas_Practice.ipynb</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #808080;}
.s1 { color: #a9b7c6;}
.s2 { color: #cc7832;}
.s3 { color: #6a8759;}
.s4 { color: #6897bb;}
</style>
</head>
<body bgcolor="#2b2b2b">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
Pandas_Practice.ipynb</font>
</center></td></tr></table>
<pre><span class="s0">#%% md 
</span><span class="s1">### Exercise 1: Pandas: DataFrame and Series  
 
**Pandas** is a popular library for data analysis built on top of the Python programming language. Pandas generally provide two data structures for manipulating data, They are:  
  
* DataFrame 
* Series 
 
A **DataFrame** is a two-dimensional data structure, i.e., data is aligned in a tabular fashion in rows and columns. 
 
* A Pandas DataFrame will be created by loading the datasets from existing storage.  
* Storage can be SQL Database, CSV file, an Excel file, etc.  
* It can also be created from the lists, dictionary, and from a list of dictionaries. 
 
**Series** represents a one-dimensional array of indexed data. 
It has two main components : 
1. An array of actual data. 
2. An associated array of indexes or data labels. 
 
The index is used to access individual data values. You can also get a column of a dataframe as a **Series**. You can think of a Pandas series as a 1-D dataframe.  
 
</span><span class="s0">#%% 
# let us import the Pandas Library</span>
<span class="s2">import </span><span class="s1">pandas </span><span class="s2">as </span><span class="s1">pd</span>
<span class="s0">#%% md 
</span><span class="s1">Once youâ€™ve imported pandas, you can then use the functions built in it to create and analyze data. 
 
</span><span class="s0">#%% md 
</span><span class="s1">**In this practice lab, we will learn how to create a DataFrame out of a dictionary.** 
 
</span><span class="s0">#%% md 
</span><span class="s1">Let us consider a dictionary 'x' with keys and values as shown below. 
 
We then create a dataframe from the dictionary using the function pd.DataFrame(dict) 
 
</span><span class="s0">#%% 
#Define a dictionary 'x'</span>

<span class="s1">x = {</span><span class="s3">'Name'</span><span class="s1">: [</span><span class="s3">'Rose'</span><span class="s2">,</span><span class="s3">'John'</span><span class="s2">, </span><span class="s3">'Jane'</span><span class="s2">, </span><span class="s3">'Mary'</span><span class="s1">]</span><span class="s2">, </span><span class="s3">'ID'</span><span class="s1">: [</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">3</span><span class="s2">, </span><span class="s4">4</span><span class="s1">]</span><span class="s2">, </span><span class="s3">'Department'</span><span class="s1">: [</span><span class="s3">'Architect Group'</span><span class="s2">, </span><span class="s3">'Software Group'</span><span class="s2">, </span><span class="s3">'Design Team'</span><span class="s2">, </span><span class="s3">'Infrastructure'</span><span class="s1">]</span><span class="s2">, </span>
      <span class="s3">'Salary'</span><span class="s1">:[</span><span class="s4">100000</span><span class="s2">, </span><span class="s4">80000</span><span class="s2">, </span><span class="s4">50000</span><span class="s2">, </span><span class="s4">60000</span><span class="s1">]}</span>

<span class="s0"># casting the dictionary to a DataFrame</span>
<span class="s1">df = pd.DataFrame(x)</span>

<span class="s0">#display the result df</span>
<span class="s1">df</span>
<span class="s0">#%% md 
</span><span class="s1">We can see the direct correspondence between the table. The keys correspond to the column labels and the values or lists corresponding to the rows. 
 
</span><span class="s0">#%% md 
</span><span class="s1">#### Column Selection: 
 
To select a column in Pandas DataFrame, we can either access the columns by calling them by their columns name.  
 
Let's Retrieve the data present in the &lt;code&gt;ID&lt;/code&gt; column. 
 
</span><span class="s0">#%% 
# Retrieving the &quot;ID&quot; column and assigning it to a variable x</span>
<span class="s1">x = df[[</span><span class="s3">'ID'</span><span class="s1">]]</span>
<span class="s1">x</span>
<span class="s0">#%% md 
</span><span class="s1">Let's use the &lt;code&gt;type()&lt;/code&gt; function and check the type of the variable. 
 
</span><span class="s0">#%% 
# check the type of x</span>
<span class="s1">type(x)</span>
<span class="s0">#%% md 
</span><span class="s1">The output shows us that the type of the variable is a DataFrame object. 
 
</span><span class="s0">#%% md 
</span><span class="s1">#### Access to multiple columns 
 
Let us retrieve the data for &lt;code&gt;Department&lt;/code&gt;, &lt;code&gt;Salary&lt;/code&gt; and &lt;code&gt;ID&lt;/code&gt; columns 
 
</span><span class="s0">#%% 
# Retrieving the Department, Salary and ID columns and assigning it to a variable z</span>

<span class="s1">z = df[[</span><span class="s3">'Department'</span><span class="s2">,</span><span class="s3">'Salary'</span><span class="s2">,</span><span class="s3">'ID'</span><span class="s1">]]</span>
<span class="s1">z</span>
<span class="s0">#%% md 
</span><span class="s1">### Try it yourself 
 
</span><span class="s0">#%% md 
</span><span class="s1">##### Problem 1: Create a dataframe to display the result as below: 
 
 
</span><span class="s0">#%% md 
</span><span class="s1">&lt;center&gt; 
    &lt;img src=&quot;https://cf-courses-data.s3.us.cloud-object-storage.appdomain.cloud/IBMDeveloperSkillsNetwork-PY0101EN-SkillsNetwork/labs/Module%204/images/Student_data.png&quot; width=&quot;300&quot; alt=&quot;Student Data&quot;&gt; 
&lt;/center&gt; 
 
</span><span class="s0">#%% 
#write your code here</span>
<span class="s2">import </span><span class="s1">pandas </span><span class="s2">as </span><span class="s1">pd</span>
<span class="s1">Data= {</span><span class="s3">'Student'</span><span class="s1">:[</span><span class="s3">'David'</span><span class="s2">,</span><span class="s3">'Samuel'</span><span class="s2">,</span><span class="s3">'Terry'</span><span class="s2">,</span><span class="s3">'Evan'</span><span class="s1">]</span><span class="s2">,</span><span class="s3">'Age'</span><span class="s1">:[</span><span class="s4">27</span><span class="s2">,</span><span class="s4">24</span><span class="s2">,</span><span class="s4">22</span><span class="s2">,</span><span class="s4">32</span><span class="s1">]</span><span class="s2">,</span><span class="s3">'Country'</span><span class="s1">:[</span><span class="s3">'UK'</span><span class="s2">,</span><span class="s3">'Canada'</span><span class="s2">,</span><span class="s3">'China'</span><span class="s2">,</span><span class="s3">'USA'</span><span class="s1">]</span><span class="s2">,</span><span class="s3">'Course'</span><span class="s1">:[</span><span class="s3">'Python'</span><span class="s2">,</span><span class="s3">'Data Structure'</span><span class="s2">,</span><span class="s3">'Machine Learning'</span><span class="s2">,</span><span class="s3">'Web Development'</span><span class="s1">]</span><span class="s2">,</span><span class="s3">'Marks'</span><span class="s1">:[</span><span class="s4">85</span><span class="s2">,</span><span class="s4">75</span><span class="s2">,</span><span class="s4">89</span><span class="s2">,</span><span class="s4">75</span><span class="s1">]}</span>
<span class="s0"># make this dictionary into dataframe</span>
<span class="s1">df = pd.DataFrame(Data)</span>
<span class="s1">df</span>
<span class="s0">#%% md 
</span><span class="s1">&lt;details&gt;&lt;summary&gt;Click here for the solution&lt;/summary&gt; 
 
```python 
a = {'Student':['David', 'Samuel', 'Terry', 'Evan'], 
     'Age':['27', '24', '22', '32'], 
     'Country':['UK', 'Canada', 'China', 'USA'], 
     'Course':['Python','Data Structures','Machine Learning','Web Development'], 
     'Marks':['85','72','89','76']} 
df1 = pd.DataFrame(a) 
df1 
     
``` 
 
&lt;/details&gt; 
 
</span><span class="s0">#%% md 
</span><span class="s1">##### Problem 2: Retrieve the Marks column and assign it to a variable b 
 
</span><span class="s0">#%% 
#write your code here</span>
<span class="s1">marks = df[[</span><span class="s3">'Marks'</span><span class="s1">]]</span>
<span class="s1">marks</span>
<span class="s0">#%% md 
</span><span class="s1">&lt;details&gt;&lt;summary&gt;Click here for the solution&lt;/summary&gt; 
 
```python 
b = df1[['Marks']] 
b 
     
``` 
 
&lt;/details&gt; 
 
</span><span class="s0">#%% md 
</span><span class="s1">##### Problem 3: Retrieve the Country and Course columns and assign it to a variable c 
 
</span><span class="s0">#%% 
#write your code here</span>
<span class="s1">z = df[[</span><span class="s3">'Country'</span><span class="s2">, </span><span class="s3">'Course'</span><span class="s1">]]</span>
<span class="s1">z</span>
<span class="s0">#%% md 
</span><span class="s1">&lt;details&gt;&lt;summary&gt;Click here for the solution&lt;/summary&gt; 
 
```python 
c = df1[['Country','Course']] 
c 
     
``` 
 
&lt;/details&gt; 
 
</span><span class="s0">#%% md 
</span><span class="s1">#### To view the column as a series, just use one bracket: 
 
</span><span class="s0">#%% 
# Get the Student column as a series Object</span>

<span class="s1">x = df[</span><span class="s3">'Student'</span><span class="s1">]</span>
<span class="s1">x</span>

<span class="s0">#%% 
# check the type of x</span>
<span class="s1">type(x)</span>
<span class="s0">#%% md 
</span><span class="s1">The output shows us that the type of the variable is a Series object. 
 
</span><span class="s0">#%% md 
</span><span class="s1">### Exercise 2: &lt;code&gt;loc()&lt;/code&gt; and &lt;code&gt;iloc()&lt;/code&gt; functions 
 
&lt;code&gt;loc()&lt;/code&gt; is a label-based data selecting method which means that we have to pass the name of the row or column that we want to select. This method includes the last element of the range passed in it. 
 
Simple syntax for your understanding:  
 
 - loc[row_label, column_label] 
 
&lt;code&gt;iloc()&lt;/code&gt; is an indexed-based selecting method which means that we have to pass integer index in the method to select a specific row/column. This method does not include the last element of the range passed in it. 
 
Simple syntax for your understanding:  
    
 - iloc[row_index, column_index] 
 
&lt;h4 id=&quot;data&quot;&gt;Let us see some examples on the same.&lt;/h4&gt; 
 
</span><span class="s0">#%% 
# Access the value on the first row and the first column</span>

<span class="s1">df.iloc[</span><span class="s4">0</span><span class="s2">, </span><span class="s4">0</span><span class="s1">]</span>

<span class="s0"># access  the value on the first row and the second column</span>
<span class="s1">df.iloc[</span><span class="s4">0</span><span class="s2">,</span><span class="s4">1</span><span class="s1">]</span>
<span class="s0">#%% 
# Access the value on the first row and the third column</span>

<span class="s1">df.iloc[</span><span class="s4">0</span><span class="s2">,</span><span class="s4">2</span><span class="s1">]</span>
<span class="s0">#%% 
# Access the column using the name</span>

<span class="s1">df.loc[</span><span class="s4">0</span><span class="s2">, </span><span class="s3">'Student'</span><span class="s1">]</span>

<span class="s0"># Access the 2nd column using the name</span>

<span class="s1">df.loc[</span><span class="s4">2</span><span class="s2">, </span><span class="s3">'Age'</span><span class="s1">]</span>



<span class="s0">#%% 
</span><span class="s1">df.iloc[</span><span class="s4">3</span><span class="s2">,</span><span class="s3">'Age'</span><span class="s1">]</span>
<span class="s0">#%% md 
</span><span class="s1">Let us create a new dataframe called 'df2' and assign 'df' to it. Now, let us set the &quot;Name&quot; column as an index column using the method set_index(). 
 
</span><span class="s0">#%% 
</span>
<span class="s0">#%% 
</span><span class="s1">df2=df</span>
<span class="s1">df2= df2.set_index([</span><span class="s3">'Student'</span><span class="s2">,</span><span class="s3">'Age'</span><span class="s1">])</span>
<span class="s0">#%% 
# To display the first 5 rows of new dataframe</span>
<span class="s1">df2.head(</span><span class="s4">5</span><span class="s1">)</span>
<span class="s0">#%% 
#Now, let us access the column using the name</span>
<span class="s1">df2.loc[</span><span class="s3">'David'</span><span class="s2">, </span><span class="s3">'Age'</span><span class="s1">]</span>

<span class="s0">#%% md 
</span><span class="s1">### Try it yourself 
 
 
</span><span class="s0">#%% 
</span><span class="s1">df2.loc[</span><span class="s4">0</span><span class="s2">,</span><span class="s3">'Course'</span><span class="s1">]</span>
<span class="s0">#%% md 
</span><span class="s1">Use the &lt;code&gt;loc()&lt;/code&gt; function,to get the Department of Jane in the newly created dataframe df2. 
 
</span><span class="s0">#%% 
# write your code here</span>
<span class="s1">df2.loc[</span><span class="s3">'Evan'</span><span class="s2">,</span><span class="s3">'Marks'</span><span class="s1">]</span>
<span class="s0">#%% md 
</span><span class="s1">&lt;details&gt;&lt;summary&gt;Click here for the solution&lt;/summary&gt; 
 
```python 
df2.loc['Jane', 'Department'] 
     
``` 
 
&lt;/details&gt; 
 
</span><span class="s0">#%% md 
</span><span class="s1">Use the &lt;code&gt;iloc()&lt;/code&gt; function,to get the Salary of Mary in the newly created dataframe df2. 
 
</span><span class="s0">#%% 
# write your code here</span>
<span class="s1">df2.iloc[</span><span class="s4">3</span><span class="s2">,</span><span class="s4">3</span><span class="s1">]</span>
<span class="s0">#%% md 
</span><span class="s1">&lt;details&gt;&lt;summary&gt;Click here for the solution&lt;/summary&gt; 
 
```python 
df2.iloc[3,2] 
     
``` 
 
&lt;/details&gt; 
 
</span><span class="s0">#%% md 
</span><span class="s1">### Exercise 3: Slicing 
 
Slicing uses the [] operator to select a set of rows and/or columns from a DataFrame. 
 
To slice out a set of rows, you use this syntax: data[start:stop],  
 
here the start represents the index from where to consider, and stop represents the index one step BEYOND the row you want to select. You can perform slicing using both the index and the name of the column. 
 
&gt; NOTE: When slicing in pandas, the start bound is included in the output. 
 
So if you want to select rows 0, 1, and 2 your code would look like this: df.iloc[0:3]. 
 
It means you are telling Python to start at index 0 and select rows 0, 1, 2 up to but not including 3. 
 
&gt; NOTE: Labels must be found in the DataFrame or you will get a KeyError. 
 
Indexing by labels(i.e. using &lt;code&gt;loc()&lt;/code&gt;) differs from indexing by integers (i.e. using &lt;code&gt;iloc()&lt;/code&gt;). With &lt;code&gt;loc()&lt;/code&gt;, both the start bound and the stop bound are inclusive. When using &lt;code&gt;loc()&lt;/code&gt;, integers can be used, but the integers refer to the index label and not the position.  
 
For example, using &lt;code&gt;loc()&lt;/code&gt; and select 1:4 will get a different result than using &lt;code&gt;iloc()&lt;/code&gt; to select rows 1:4. 
 
&lt;h4 id=&quot;data&quot;&gt;We can also select a specific data value using a row and column location within the DataFrame and iloc indexing. 
 
</span><span class="s0">#%% 
# let us do the slicing using old dataframe df</span>

<span class="s1">df.iloc[</span><span class="s4">0</span><span class="s1">:</span><span class="s4">2</span><span class="s2">, </span><span class="s4">0</span><span class="s1">:</span><span class="s4">3</span><span class="s1">]</span>
<span class="s0">#%% 
#let us do the slicing using loc() function on old dataframe df where index column is having labels as 0,1,2</span>
<span class="s1">df.loc[</span><span class="s4">0</span><span class="s1">:</span><span class="s4">2</span><span class="s2">,</span><span class="s3">'ID'</span><span class="s1">:</span><span class="s3">'Department'</span><span class="s1">]</span>
<span class="s0">#%% 
#let us do the slicing using loc() function on new dataframe df2 where index column is Name having labels: Rose, John and Jane</span>
<span class="s1">df2.loc[</span><span class="s3">'Rose'</span><span class="s1">:</span><span class="s3">'Jane'</span><span class="s2">, </span><span class="s3">'ID'</span><span class="s1">:</span><span class="s3">'Department'</span><span class="s1">]</span>
<span class="s0">#%% md 
</span><span class="s1">&lt;h2 id=&quot;quiz&quot;&gt;Try it yourself&lt;/h2&gt; 
 
</span><span class="s0">#%% md 
</span><span class="s1">using &lt;code&gt;loc()&lt;/code&gt; function, do slicing on old dataframe df to retrieve the Name, ID and department of index column having labels as 2,3 
 
 
</span><span class="s0">#%% 
# Write your code below and press Shift+Enter to execute</span>

<span class="s0">#%% md 
</span><span class="s1">&lt;details&gt;&lt;summary&gt;Click here for the solution&lt;/summary&gt; 
 
```python 
df.loc[2:3,'Name':'Department'] 
     
``` 
 
&lt;/details&gt; 
 
</span><span class="s0">#%% md 
</span>
</pre>
</body>
</html>